import{e as q,a as F,p as K,r as u,aJ as G,aK as J,aL as W,aM as X,c as z,j as e,b as k,X as Z,L as Q,a8 as ee,C as ae,R as t,a9 as se,aN as ne,l as oe,aO as te,aP as ie}from"./index-xg0wAXn9.js";import{v as H,w as B,t as le,S as ce,a as re,b as _e,d as de,m as ue,l as he,R as me,C as fe,g as O,h as ve}from"./solicitudesQueries-D0yC5ypa.js";import{B as U}from"./GlassPanel-DsiEcOyo.js";import{a as D}from"./useModalScroll-bImGwwMj.js";const y=()=>{const a=q(),{session:s}=F(),{activeRole:o,availableRoles:c}=K(_=>_.role),i=u.useRef(!1),r=s.user?.roles?JSON.stringify(s.user.roles.sort()):"";u.useEffect(()=>{s.user?.roles&&s.user.roles.length>0?i.current||(i.current=!0,a(G(s.user.roles)),a(J())):i.current&&(i.current=!1,a(W()))},[r,a]);const p=u.useCallback(_=>{a(X(_))},[a]),x=u.useCallback(_=>c.includes(_),[c]),v=u.useCallback(_=>o?_.includes(o):!1,[o]);return{activeRole:o,availableRoles:c,switchRole:p,hasRole:x,canAccess:v,hasMultipleRoles:c.length>1}};const pe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],xe=z("chevron-right",pe);const be=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ge=z("chevron-left",be),Ne="_fadeIn_53v8i_1",je="_slideInUp_53v8i_1",Ce="_scaleIn_53v8i_1",Se="_bounce_53v8i_1",Re="_pulse_53v8i_1",Ae="_spin_53v8i_1",we="_shake_53v8i_1",Ee="_float_53v8i_1",$e="_icon_53v8i_216",Ie="_button_53v8i_295",Pe="_primary_53v8i_318",Te="_secondary_53v8i_329",Me="_danger_53v8i_337",Le="_sm_53v8i_348",Ue="_md_53v8i_367",ke="_lg_53v8i_385",Oe="_fadeOut_53v8i_1",De="_shine_53v8i_1",L={"animate-fade-in":"_animate-fade-in_53v8i_79",fadeIn:Ne,"animate-slide-in-up":"_animate-slide-in-up_53v8i_83",slideInUp:je,"animate-scale-in":"_animate-scale-in_53v8i_87",scaleIn:Ce,"animate-bounce":"_animate-bounce_53v8i_91",bounce:Se,"animate-pulse":"_animate-pulse_53v8i_95",pulse:Re,"animate-spin":"_animate-spin_53v8i_99",spin:Ae,"animate-shake":"_animate-shake_53v8i_103",shake:we,"animate-float":"_animate-float_53v8i_161",float:Ee,"animate-float-slow":"_animate-float-slow_53v8i_165","float-slow":"_float-slow_53v8i_1","animate-pulse-slow":"_animate-pulse-slow_53v8i_169","pulse-slow":"_pulse-slow_53v8i_1","animate-ping-slow":"_animate-ping-slow_53v8i_173","ping-slow":"_ping-slow_53v8i_1","animate-slide-in":"_animate-slide-in_53v8i_83","slide-in":"_slide-in_53v8i_1","elevation-0":"_elevation-0_53v8i_181","elevation-1":"_elevation-1_53v8i_185","elevation-2":"_elevation-2_53v8i_189","elevation-3":"_elevation-3_53v8i_193","elevation-4":"_elevation-4_53v8i_197","elevation-5":"_elevation-5_53v8i_201","elevation-transition":"_elevation-transition_53v8i_205","elevation-hover":"_elevation-hover_53v8i_209",icon:$e,"icon--xs":"_icon--xs_53v8i_221","icon--sm":"_icon--sm_53v8i_225","icon--md":"_icon--md_53v8i_229","icon--lg":"_icon--lg_53v8i_233","icon--xl":"_icon--xl_53v8i_237","icon--2xl":"_icon--2xl_53v8i_241","icon--primary":"_icon--primary_53v8i_245","icon--secondary":"_icon--secondary_53v8i_248","icon--muted":"_icon--muted_53v8i_251","icon--brand":"_icon--brand_53v8i_254","icon--success":"_icon--success_53v8i_257","icon--warning":"_icon--warning_53v8i_260","icon--error":"_icon--error_53v8i_263","icon--disabled":"_icon--disabled_53v8i_266","icon--interactive":"_icon--interactive_53v8i_269",button:Ie,primary:Pe,secondary:Te,danger:Me,sm:Le,md:Ue,lg:ke,fadeOut:Oe,shine:De};function Y({variant:a="primary",size:s="md",children:o,className:c="",...i}){const r=[L.button,L[a],L[s],c].filter(Boolean).join(" ");return e.jsx("button",{className:r,...i,children:o})}const $={"role-selector":"_role-selector_1m8r3_1","role-selector__label":"_role-selector__label_1m8r3_11","role-selector__buttons":"_role-selector__buttons_1m8r3_18","role-button":"_role-button_1m8r3_23"},Fe={admin:"Administrador",alumno:"Estudiante",profesor:"Profesor"},ze=({className:a})=>{const{activeRole:s,availableRoles:o,switchRole:c,hasMultipleRoles:i}=y();return i?e.jsxs("div",{className:`${$["role-selector"]} ${a||""}`,children:[e.jsx("span",{className:$["role-selector__label"],children:"Rol activo:"}),e.jsx("div",{className:$["role-selector__buttons"],children:o.map(r=>e.jsx(Y,{onClick:()=>c(r),variant:s===r?"primary":"secondary",size:"sm",className:$["role-button"],children:Fe[r]||r},r))})]}):null},He=({onClose:a,onOpenRenovacion:s,onOpenClasePrivada:o})=>{const c=k(),{data:i=[],isLoading:r}=H(),{data:p=[],isLoading:x}=B(),v=i.length+p.length,_=r||x,b=()=>{c(t.ADMIN.NOTIFICATIONS),a()},h=(l,m)=>{l==="renovacion"&&s?s(m):l==="clase-privada"&&o&&o(m),a()};return e.jsx("div",{className:"absolute top-full right-0 mt-2 w-[380px] max-h-[500px] overflow-hidden z-50",children:e.jsxs("div",{className:"p-0 rounded-xl shadow-2xl overflow-hidden",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.98), rgba(13, 13, 13, 0.98))",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 90, 248, 0.2)",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(124, 90, 248, 0.1)"},children:[e.jsx("div",{className:"p-4 border-b border-[rgba(255,255,255,0.1)]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-[#c93448]"}),e.jsx("h3",{className:"text-[#f9fafb] font-semibold",children:"Notificaciones"}),v>0&&e.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-[#c93448] text-white text-xs font-bold",children:v})]}),e.jsx("button",{onClick:a,className:"text-[#9ca3af] hover:text-[#f9fafb] transition-colors",children:e.jsx(Z,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"max-h-[350px] overflow-y-auto",children:_?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Q,{className:"w-8 h-8 text-[#7c5af8] animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-[#9ca3af] text-sm",children:"Cargando notificaciones..."})]}):v===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(U,{className:"w-12 h-12 text-[#4b5563] mx-auto mb-3"}),e.jsx("p",{className:"text-[#9ca3af] text-sm",children:"No hay notificaciones pendientes"})]}):e.jsxs("div",{className:"divide-y divide-[rgba(255,255,255,0.05)]",children:[i.map(l=>e.jsx("button",{onClick:()=>h("renovacion",l),className:"w-full p-4 text-left hover:bg-[rgba(255,255,255,0.03)] transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[rgba(201,52,72,0.15)] flex items-center justify-center shrink-0",children:e.jsx(ee,{className:"w-5 h-5 text-[#c93448]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[#f9fafb] text-sm font-medium mb-1",children:l.nombreAlumno}),e.jsx("p",{className:"text-[#9ca3af] text-xs mb-1",children:"Solicita renovar paquete"}),l.clasesRestantes!==null&&e.jsxs("p",{className:"text-[#f59e0b] text-xs",children:[l.clasesRestantes," clases restantes"]})]}),e.jsx(D,{className:"w-4 h-4 text-[#10b981] shrink-0"})]})},`renovacion-${l.idSolicitud}`)),p.map(l=>e.jsx("button",{onClick:()=>h("clase-privada",l),className:"w-full p-4 text-left hover:bg-[rgba(255,255,255,0.03)] transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[rgba(124,90,248,0.15)] flex items-center justify-center shrink-0",children:e.jsx(le,{className:"w-5 h-5 text-[#7c5af8]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[#f9fafb] text-sm font-medium mb-1",children:l.nombreAlumno}),e.jsx("p",{className:"text-[#9ca3af] text-xs mb-1",children:"Solicita clase privada"}),l.fechaPreferida&&e.jsxs("div",{className:"flex items-center gap-1 text-[#7c5af8] text-xs",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{children:new Date(l.fechaPreferida).toLocaleDateString("es-ES",{day:"2-digit",month:"short"})})]})]}),e.jsx(D,{className:"w-4 h-4 text-[#10b981] shrink-0"})]})},`clase-${l.idSolicitud}`))]})}),v>0&&e.jsx("div",{className:"p-3 border-t border-[rgba(255,255,255,0.1)]",children:e.jsx("button",{onClick:b,className:"w-full py-2 text-center text-[#7c5af8] hover:text-[#6845e8] text-sm font-medium transition-colors",children:"Ver todas las notificaciones"})})]})})},Be=a=>{const s=k();return{navigate:c=>{const i=c.trim().toLowerCase();i&&(a==="profesor"?Ye(i,c,s):a==="alumno"?Ve(i,c,s):ye(i,c,s))}}};function ye(a,s,o){if(/^\d+$/.test(a)){o(`${t.ADMIN.PAYMENTS}?search=${encodeURIComponent(a)}`);return}if(a.includes("pago")||a.includes("payment")){o(`${t.ADMIN.PAYMENTS}?search=${encodeURIComponent(s)}`);return}if(a.includes("clase")||a.includes("class")){o(`${t.ADMIN.CLASSES}?search=${encodeURIComponent(s)}`);return}if(a.includes("paquete")||a.includes("package")){o(`${t.ADMIN.PACKAGES}?search=${encodeURIComponent(s)}`);return}if(a.includes("asistencia")||a.includes("attendance")){o(`${t.ADMIN.ATTENDANCE}?search=${encodeURIComponent(s)}`);return}if(a.includes("nomina")||a.includes("payroll")){o(`${t.ADMIN.PAYROLL}?search=${encodeURIComponent(s)}`);return}if(a.includes("reporte")||a.includes("report")){o(`${t.ADMIN.REPORTS}?search=${encodeURIComponent(s)}`);return}o(`${t.ADMIN.USERS}?search=${encodeURIComponent(s)}`)}function Ye(a,s,o){if(/^\d+$/.test(a)){o(`${t.TEACHER.CLASSES}?search=${encodeURIComponent(a)}`);return}if(a.includes("clase")||a.includes("class")){o(`${t.TEACHER.CLASSES}?search=${encodeURIComponent(s)}`);return}if(a.includes("asistencia")||a.includes("attendance")){o(`${t.TEACHER.ATTENDANCE}?search=${encodeURIComponent(s)}`);return}if(a.includes("reporte")||a.includes("report")){o(`${t.TEACHER.REPORTS}?search=${encodeURIComponent(s)}`);return}if(a.includes("pago")||a.includes("payment")){o(`${t.TEACHER.PAYMENTS}?search=${encodeURIComponent(s)}`);return}o(`${t.TEACHER.CLASSES}?search=${encodeURIComponent(s)}`)}function Ve(a,s,o){if(/^\d+$/.test(a)){o(`${t.STUDENT.PAYMENTS}?search=${encodeURIComponent(a)}`);return}if(a.includes("pago")||a.includes("payment")){o(`${t.STUDENT.PAYMENTS}?search=${encodeURIComponent(s)}`);return}if(a.includes("clase")||a.includes("class")){o(`${t.STUDENT.CLASSES}?search=${encodeURIComponent(s)}`);return}if(a.includes("asistencia")||a.includes("attendance")){o(`${t.STUDENT.ATTENDANCE}?search=${encodeURIComponent(s)}`);return}if(a.includes("horario")||a.includes("schedule")){o(`${t.STUDENT.CLASSES_SCHEDULE}`);return}o(`${t.STUDENT.CLASSES}?search=${encodeURIComponent(s)}`)}function qe(a){if(!a)return"Panel";const s=a.toLowerCase();return{alumno:"Estudiante",profesor:"Profesor",admin:"Administrador",administrador:"Administrador"}[s]||"Panel"}function Ke(a){return!a||a.length===0?"Panel":qe(a[0])}const Ge="_sidebar_gu4al_306",Je="_sidebar__header_gu4al_325",We="_sidebar__brand_gu4al_363",Xe="_brand__icon_gu4al_369",Ze="_brand__text_gu4al_385",Qe="_brand__title_gu4al_396",ea="_brand__subtitle_gu4al_410",aa="_sidebar__toggle_gu4al_424",sa="_sidebar__nav_gu4al_444",na="_header_gu4al_510",oa="_header__left_gu4al_540",ta="_header__logo_gu4al_550",ia="_logo__circle_gu4al_564",la="_logo__text_gu4al_580",ca="_logo__subtitle_gu4al_596",ra="_header__right_gu4al_658",_a="_header__search_gu4al_666",da="_header__user_gu4al_736",n={"main-layout":"_main-layout_gu4al_295",sidebar:Ge,"sidebar--closed":"_sidebar--closed_gu4al_321",sidebar__header:Je,"sidebar__header-line":"_sidebar__header-line_gu4al_342","sidebar__vertical-line":"_sidebar__vertical-line_gu4al_352",sidebar__brand:We,brand__icon:Xe,brand__text:Ze,brand__title:Qe,brand__subtitle:ea,sidebar__toggle:aa,sidebar__nav:sa,"nav-item":"_nav-item_gu4al_453","nav-item--active":"_nav-item--active_gu4al_471","nav-item__icon":"_nav-item__icon_gu4al_490","nav-item__label":"_nav-item__label_gu4al_499","main-container":"_main-container_gu4al_503",header:na,header__left:oa,header__logo:ta,logo__circle:ia,"logo__text-container":"_logo__text-container_gu4al_580",logo__text:la,logo__subtitle:ca,"status-badge":"_status-badge_gu4al_622","status-badge__dot":"_status-badge__dot_gu4al_633","status-badge__text":"_status-badge__text_gu4al_650",header__right:ra,header__search:_a,"search-input":"_search-input_gu4al_686","header__icon-btn":"_header__icon-btn_gu4al_699","header__icon-btn-wrapper":"_header__icon-btn-wrapper_gu4al_717","notification-badge":"_notification-badge_gu4al_721",header__user:da,"user-avatar":"_user-avatar_gu4al_751","user-info":"_user-info_gu4al_762","user-name":"_user-name_gu4al_767","user-role":"_user-role_gu4al_775","logout-btn":"_logout-btn_gu4al_783","main-content":"_main-content_gu4al_803"},ua=({user:a,onLogout:s,navigationItems:o=[],onOpenRenovacion:c,onOpenClasePrivada:i})=>{const[r,p]=u.useState(!0),[x,v]=u.useState(""),[_,b]=u.useState(!1),[h,l]=u.useState(!1),m=u.useRef(null),R=se(),C=k(),N=a?.roles?.includes("admin"),g=N?"admin":a?.roles?.includes("profesor")?"profesor":"alumno",{navigate:I}=Be(g),{data:A=[]}=H(N),{data:P=[]}=B(N),T=f=>R.pathname===f,S=Ke(a?.roles),j=A.length+P.length,d=j>0&&!h;u.useEffect(()=>{j>0&&l(!1)},[j]),u.useEffect(()=>{const f=E=>{m.current&&!m.current.contains(E.target)&&b(!1)};return _&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[_]);const M=f=>{f.preventDefault(),x.trim()&&(I(x),v(""))},w=()=>{g==="admin"?C(t.ADMIN.PROFILE):g==="profesor"?C(t.TEACHER.PROFILE):g==="alumno"&&C(t.STUDENT.PROFILE)},V=()=>{_||l(!0),b(!_)};return e.jsxs("div",{className:n["main-layout"],children:[e.jsxs("aside",{className:`${n.sidebar} ${r?n["sidebar--open"]:n["sidebar--closed"]}`,children:[e.jsxs("div",{className:n.sidebar__header,children:[e.jsxs("div",{className:n.sidebar__brand,children:[e.jsx("div",{className:n.brand__icon,children:"C"}),e.jsxs("div",{className:n.brand__text,children:[e.jsx("h1",{className:n.brand__title,children:"Chetango"}),e.jsx("p",{className:n.brand__subtitle,children:S})]})]}),e.jsx("div",{className:n["sidebar__header-line"]})]}),e.jsx("div",{className:n["sidebar__vertical-line"]}),e.jsx("nav",{className:n.sidebar__nav,children:o.map(f=>{const E=f.icon;return e.jsxs(ne,{to:f.path,className:`${n["nav-item"]} ${T(f.path)?n["nav-item--active"]:""}`,children:[E&&e.jsx("span",{className:n["nav-item__icon"],children:e.jsx(E,{size:20})}),r&&e.jsx("span",{className:n["nav-item__label"],children:f.label})]},f.path)})}),e.jsx("button",{className:n.sidebar__toggle,onClick:()=>p(!r),"aria-label":r?"Cerrar menú":"Abrir menú",children:r?e.jsx(ge,{size:20}):e.jsx(xe,{size:20})})]}),e.jsxs("div",{className:n["main-container"],children:[e.jsxs("header",{className:n.header,children:[e.jsxs("div",{className:n.header__left,children:[e.jsxs("div",{className:n.header__logo,children:[e.jsx("div",{className:n.logo__circle,children:"C"}),e.jsxs("div",{className:n["logo__text-container"],children:[e.jsx("span",{className:n.logo__text,children:"Chetango"}),e.jsx("span",{className:n.logo__subtitle,children:S})]})]}),e.jsxs("div",{className:n["status-badge"],children:[e.jsx("span",{className:n["status-badge__dot"]}),e.jsx("span",{className:n["status-badge__text"],children:"Sistema Activo"})]})]}),e.jsxs("div",{className:n.header__right,children:[e.jsxs("form",{onSubmit:M,className:n.header__search,children:[e.jsx(ce,{size:16}),e.jsx("input",{type:"text",placeholder:"Buscar...",className:n["search-input"],value:x,onChange:f=>v(f.target.value)})]}),N&&e.jsxs("div",{className:n["header__icon-btn-wrapper"],ref:m,children:[e.jsxs("button",{className:n["header__icon-btn"],"aria-label":"Notificaciones",onClick:V,children:[e.jsx(U,{size:20}),d&&e.jsx("span",{className:n["notification-badge"],children:j})]}),_&&e.jsx(He,{onClose:()=>b(!1),onOpenRenovacion:c,onOpenClasePrivada:i})]}),e.jsxs("button",{className:n.header__user,onClick:w,style:{cursor:"pointer"},children:[e.jsx("div",{className:n["user-avatar"],children:e.jsx(oe,{size:16})}),a&&e.jsxs("div",{className:n["user-info"],children:[e.jsx("span",{className:n["user-name"],children:a.name||"Usuario"}),e.jsx("span",{className:n["user-role"],children:S})]})]}),s&&e.jsx(Y,{onClick:s,variant:"secondary",size:"sm",className:n["logout-btn"],children:"Cerrar Sesión"})]})]}),e.jsx("main",{className:n["main-content"],children:e.jsx(te,{})})]})]})},ha=()=>{const{logout:a,session:s}=F(),{activeRole:o}=y(),c=s?.user?.roles?.includes("admin"),{data:i=[]}=re(),{data:r=[]}=_e(c),p=de(),[x,v]=u.useState(!1),[_,b]=u.useState(!1),[h,l]=u.useState(null),[m,R]=u.useState(null),C=async()=>{try{await a()}catch{}},N=d=>{l(d),v(!0)},g=()=>{v(!1),l(null)},I=d=>{R(d),b(!0)},A=()=>{b(!1),R(null)},P=async d=>{const M={profesores:d.profesores.map(w=>({idProfesor:w.idProfesor,rolEnClase:w.rolEnClase})),idTipoClase:d.idTipoClase,fecha:ve(d.fecha,"00:00"),horaInicio:O(d.horaInicio),horaFin:O(d.horaFin),cupoMaximo:d.cupoMaximo,observaciones:d.observaciones||void 0};await p.mutateAsync(M),A()},T=ie(o),S=h?[`Renovación solicitada por ${h.nombreAlumno}`,h.tipoPaqueteDeseado&&`Desea: ${h.tipoPaqueteDeseado}`,h.mensajeAlumno&&`Mensaje: ${h.mensajeAlumno}`].filter(Boolean).join(" | "):void 0,j=m?{fecha:m.fechaPreferida?he(m.fechaPreferida):"",horaInicio:m.horaPreferida?ue(m.horaPreferida):"",horaFin:"",idTipoClase:i.find(d=>d.nombre.toLowerCase().includes(m.tipoClaseDeseado?.toLowerCase()||""))?.id||"",observaciones:[`Solicitud clase privada - ${m.nombreAlumno}`,m.observacionesAlumno].filter(Boolean).join(" | ")}:void 0;return e.jsxs(e.Fragment,{children:[e.jsx(ua,{user:s.user,onLogout:C,navigationItems:T,roleSelector:e.jsx(ze,{}),onOpenRenovacion:N,onOpenClasePrivada:I}),e.jsx(me,{isOpen:x,onClose:g,onSuccess:g,initialAlumno:h?{idAlumno:h.idAlumno,nombre:h.nombreAlumno,correo:h.correoAlumno}:null,initialNota:S}),e.jsx(fe,{isOpen:_,onClose:A,onSubmit:P,tiposClase:i,profesores:r,isCatalogsLoading:!1,isSubmitting:p.isPending,mode:"create",initialData:null,prefillData:j})]})},xa=Object.freeze(Object.defineProperty({__proto__:null,MainLayoutWrapper:ha},Symbol.toStringTag,{value:"Module"}));export{ge as C,ha as M,xe as a,xa as b};
