import{c as T,r as m,j as e,X as P,C as F,L as j,a8 as E}from"./index-xg0wAXn9.js";import{A as $}from"./AmbientGlows-DQ_86F5f.js";import{t as z,v as _,w as G,a as H,b as B,d as Q,l as V,m as X,R as J,C as K,g as w,h as U}from"./solicitudesQueries-D0yC5ypa.js";import{G as g,B as u}from"./GlassPanel-DsiEcOyo.js";import{C as W,a as S}from"./useModalScroll-bImGwwMj.js";const Y=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],A=T("circle-x",Y),Z=({solicitud:a,onDismiss:d,onApprove:l,onReject:o})=>{const[i,n]=m.useState(!1),x=async()=>{if(l){n(!0);try{await l(a.idSolicitud)}finally{n(!1)}}},r=async()=>{if(o){n(!0);try{await o(a.idSolicitud)}finally{n(!1)}}};return e.jsxs(g,{className:"p-4 relative overflow-hidden group hover:scale-[1.01] transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#7c5af8]/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),d&&e.jsx("button",{onClick:d,className:"absolute top-3 right-3 text-[#9ca3af] hover:text-[#f9fafb] transition-colors",disabled:i,children:e.jsx(P,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[rgba(124,90,248,0.15)] flex items-center justify-center shrink-0",children:e.jsx(z,{className:"w-6 h-6 text-[#7c5af8] animate-pulse"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-[#f9fafb] font-semibold text-sm",children:a.nombreAlumno}),e.jsx("span",{className:"text-[#9ca3af] text-xs",children:"solicita clase privada"})]}),e.jsxs("div",{className:"space-y-1 mb-3",children:[a.tipoClaseDeseado&&e.jsxs("p",{className:"text-[#9ca3af] text-xs",children:["Tipo: ",e.jsx("span",{className:"text-[#f9fafb]",children:a.tipoClaseDeseado})]}),a.fechaPreferida&&e.jsxs("div",{className:"flex items-center gap-2 text-[#9ca3af] text-xs",children:[e.jsx(F,{className:"w-3 h-3"}),e.jsxs("span",{children:["Fecha preferida: ",e.jsx("span",{className:"text-[#f9fafb]",children:new Date(a.fechaPreferida).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})})]})]}),a.horaPreferida&&e.jsxs("div",{className:"flex items-center gap-2 text-[#9ca3af] text-xs",children:[e.jsx(W,{className:"w-3 h-3"}),e.jsxs("span",{children:["Hora: ",e.jsx("span",{className:"text-[#f9fafb]",children:a.horaPreferida})]})]}),a.observacionesAlumno&&e.jsxs("p",{className:"text-[#9ca3af] text-xs italic mt-2",children:['"',a.observacionesAlumno,'"']})]}),e.jsxs("div",{className:"flex gap-2",children:[l&&e.jsxs("button",{onClick:x,disabled:i,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg bg-[#7c5af8] hover:bg-[#6b4fd6] text-white text-xs font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[i?e.jsx(j,{className:"w-3 h-3 animate-spin"}):e.jsx(S,{className:"w-3 h-3"}),"Agendar"]}),o&&e.jsxs("button",{onClick:r,disabled:i,className:"flex items-center justify-center gap-2 px-3 py-2 rounded-lg bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(255,255,255,0.08)] text-[#9ca3af] hover:text-[#f9fafb] text-xs font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[i?e.jsx(j,{className:"w-3 h-3 animate-spin"}):e.jsx(A,{className:"w-3 h-3"}),"Ignorar"]})]}),e.jsx("p",{className:"text-[#6b7280] text-xs mt-2",children:new Date(a.fechaSolicitud).toLocaleString("es-ES",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})]})},ee=({solicitud:a,onDismiss:d,onApprove:l,onReject:o})=>{const[i,n]=m.useState(!1),x=async()=>{if(l){n(!0);try{await l(a.idSolicitud)}finally{n(!1)}}},r=async()=>{if(o){n(!0);try{await o(a.idSolicitud)}finally{n(!1)}}};return e.jsxs(g,{className:"p-4 relative overflow-hidden group hover:scale-[1.01] transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#c93448]/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),d&&e.jsx("button",{onClick:d,className:"absolute top-3 right-3 text-[#9ca3af] hover:text-[#f9fafb] transition-colors",disabled:i,children:e.jsx(P,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[rgba(201,52,72,0.15)] flex items-center justify-center shrink-0",children:e.jsx(E,{className:"w-6 h-6 text-[#c93448] animate-pulse"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-[#f9fafb] font-semibold text-sm",children:a.nombreAlumno}),e.jsx("span",{className:"text-[#9ca3af] text-xs",children:"quiere renovar su paquete"})]}),e.jsxs("div",{className:"space-y-1 mb-3",children:[a.tipoPaqueteActual&&e.jsxs("p",{className:"text-[#9ca3af] text-xs",children:["Paquete actual: ",e.jsx("span",{className:"text-[#f9fafb]",children:a.tipoPaqueteActual})]}),a.clasesRestantes!==null&&a.clasesRestantes!==void 0&&e.jsxs("p",{className:"text-[#9ca3af] text-xs",children:["Clases restantes: ",e.jsx("span",{className:"text-[#f59e0b] font-medium",children:a.clasesRestantes})]}),a.tipoPaqueteDeseado&&e.jsxs("p",{className:"text-[#9ca3af] text-xs",children:["Desea: ",e.jsx("span",{className:"text-[#f9fafb]",children:a.tipoPaqueteDeseado})]}),a.mensajeAlumno&&e.jsxs("p",{className:"text-[#9ca3af] text-xs italic mt-2",children:['"',a.mensajeAlumno,'"']})]}),e.jsxs("div",{className:"flex gap-2",children:[l&&e.jsxs("button",{onClick:x,disabled:i,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg bg-[#10b981] hover:bg-[#059669] text-white text-xs font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[i?e.jsx(j,{className:"w-3 h-3 animate-spin"}):e.jsx(S,{className:"w-3 h-3"}),"Ver Solicitud"]}),o&&e.jsxs("button",{onClick:r,disabled:i,className:"flex items-center justify-center gap-2 px-3 py-2 rounded-lg bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(255,255,255,0.08)] text-[#9ca3af] hover:text-[#f9fafb] text-xs font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[i?e.jsx(j,{className:"w-3 h-3 animate-spin"}):e.jsx(A,{className:"w-3 h-3"}),"Ignorar"]})]}),e.jsx("p",{className:"text-[#6b7280] text-xs mt-2",children:new Date(a.fechaSolicitud).toLocaleString("es-ES",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})]})},ae=({maxItems:a=5,onOpenRenovacion:d,onOpenClasePrivada:l})=>{const{data:o=[],isLoading:i}=_(),{data:n=[],isLoading:x}=G(),r=o.length+n.length;if(i||x)return e.jsx(g,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-[#9ca3af]",children:[e.jsx(u,{className:"w-5 h-5 animate-pulse"}),e.jsx("span",{className:"text-sm",children:"Cargando notificaciones..."})]})});if(r===0)return e.jsx(g,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-[#9ca3af]",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"No hay solicitudes pendientes"})]})});const f=[...o.map(s=>({...s,type:"renovacion"})),...n.map(s=>({...s,type:"clase-privada"}))].sort((s,h)=>new Date(h.fechaSolicitud).getTime()-new Date(s.fechaSolicitud).getTime()).slice(0,a);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(u,{className:"w-5 h-5 text-[#c93448]"}),e.jsx("h3",{className:"text-[#f9fafb] text-xl font-semibold",children:"Solicitudes Pendientes"}),e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-[#c93448] text-white text-xs font-bold",children:r}),e.jsx("div",{className:"flex-1 h-[2px] bg-gradient-to-r from-[rgba(255,255,255,0.08)] to-transparent"})]}),e.jsx("div",{className:"space-y-4",children:f.map(s=>s.type==="renovacion"?e.jsx(ee,{solicitud:s,onApprove:()=>{d?.(s)},onDismiss:()=>{console.log("Ignorar notificación:",s.idSolicitud)}},`renovacion-${s.idSolicitud}`):e.jsx(Z,{solicitud:s,onApprove:()=>{l?.(s)},onDismiss:()=>{console.log("Ignorar notificación:",s.idSolicitud)}},`clase-${s.idSolicitud}`))}),r>a&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("button",{className:"text-[#c93448] hover:text-[#f9fafb] text-sm font-medium transition-colors",children:["Ver todas (",r,")"]})})]})},se=()=>{const{data:a=[],isLoading:d}=H(),{data:l=[],isLoading:o}=B(),i=Q(),[n,x]=m.useState(!1),[r,f]=m.useState(!1),[s,h]=m.useState(null),[c,v]=m.useState(null),M=d||o,I=m.useMemo(()=>{if(!s)return;const t=[`Renovación solicitada por ${s.nombreAlumno}`];return s.tipoPaqueteDeseado&&t.push(`Desea: ${s.tipoPaqueteDeseado}`),s.mensajeAlumno&&t.push(`Mensaje: ${s.mensajeAlumno}`),t.join(" | ")},[s]),k=m.useMemo(()=>{if(!c)return;const t=c.tipoClaseDeseado?.toLowerCase(),b=t?a.find(C=>C.nombre.toLowerCase()===t||C.nombre.toLowerCase().includes(t)):void 0,p=c.fechaPreferida?V(c.fechaPreferida):"",q=c.horaPreferida?X(c.horaPreferida):"",y=[`Solicitud clase privada - ${c.nombreAlumno}`];return c.observacionesAlumno&&y.push(c.observacionesAlumno),{fecha:p,horaInicio:q,horaFin:"",idTipoClase:b?.id||"",observaciones:y.join(" | ")}},[c,a]),L=t=>{h(t),x(!0)},N=()=>{x(!1),h(null)},D=t=>{v(t),f(!0)},O=()=>{f(!1),v(null)},R=async t=>{const b={profesores:t.profesores.map(p=>({idProfesor:p.idProfesor,rolEnClase:p.rolEnClase})),idTipoClase:t.idTipoClase,fecha:U(t.fecha,"00:00"),horaInicio:w(t.horaInicio),horaFin:w(t.horaFin),cupoMaximo:t.cupoMaximo,observaciones:t.observaciones||void 0};await i.mutateAsync(b)};return e.jsxs("div",{className:"relative overflow-hidden min-h-screen",children:[e.jsx($,{variant:"default"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-6 md:px-8 lg:px-12 py-8 md:py-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(u,{className:"w-8 h-8 text-[#c93448]"}),e.jsx("h1",{className:"text-[#f9fafb] text-3xl md:text-4xl font-bold",children:"Notificaciones"})]}),e.jsx("p",{className:"text-[#9ca3af] text-lg",children:"Gestiona todas las solicitudes y alertas del sistema"})]}),e.jsx(ae,{maxItems:20,onOpenRenovacion:L,onOpenClasePrivada:D}),e.jsx(J,{isOpen:n,onClose:N,onSuccess:N,initialAlumno:s?{idAlumno:s.idAlumno,nombre:s.nombreAlumno,correo:s.correoAlumno}:null,initialNota:I}),e.jsx(K,{isOpen:r,onClose:O,onSubmit:R,tiposClase:a,profesores:l,isCatalogsLoading:M,isSubmitting:i.isPending,mode:"create",initialData:null,prefillData:k})]})})]})},re=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{A as C,se as N,ae as S,re as a};
